// TODO: find a better way to do this
//       e.g. actually READ stdout

var     FFI = require( 'node-ffi' )
  ,      fs = require( 'fs' )
  ,    libc = new FFI.Library(null, {
	'system': ['int32', ['string']]
})
  ,     run = libc.system
  , outFile = 'run-sync-output';

module.exports = function( cmd ){
	var res = run( cmd + ' >> ' + outFile );
	if( res !== 0 ){
		throw new Error( cmd + ' returned exit code of ' + res );
	}

	var res = fs.readFileSync( outFile ) + '';
	run( 'rm ' + outFile );

	// strip trailing line-break
	// (mostly just to be nice for commands that only return one line)
	return res.replace( /\n$/, '' );
}